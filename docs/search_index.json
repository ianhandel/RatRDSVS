[
["index.html", "R @ R(D)SVS R @ R(D)SVS", " R @ R(D)SVS Jill R D MacKay 2020-08-11 R @ R(D)SVS This book will help you get started in R. It’s designed for students (and staff) at R(D)SVS, and is free to use and adapt. "],
["about.html", "About this book 0.1 How to use this book 0.2 Tips for using an online textbook", " About this book 0.1 How to use this book This book is a manual to help you get started in R. There is text like this which is important. At the start of every chapter it will summarise what you need to know, or let you know if you can skip the chapter. You will also see text like this which is called a code block print(&quot;Hello, I am a code block!&quot;) Throughout the book, code blocks will be used to give you examples of how R works. Sometimes code blocks will also have the output block following it. ## [1] &quot;Hello, I am an output block!&quot; You can tell output blocks because they have two ## symbol to show you that it is output. Often we will see code blocks and output blocks together, like this: print(&quot;Hello, I am a code block with an output block!&quot;) ## [1] &quot;Hello, I am a code block with an output block!&quot; Sometimes you will see text like this - which is really important: When you are running code blocks in R make sure to only copy and paste the code block - not the output block! Pasting an output block into R will not do anything. You will also sometimes see bits of code or words in text like this. This is usually the name of something in R, or a short piece of code that I didn’t want to put in a full code chunk. You will also see text like this, which will explain in plain English what the r code is doing. E.g. the code 2 + 2 tells R to perform the following calculation: 2 + 2 Sometimes there will also be links to videos. These are optional for those learners who like to watch something being demonstrated. Finally - sometimes there will be footnotes!1 0.1.1 As a student in class If I have set this book as your reading, you will be told what chapters you need to read and when in class. You are very lucky because you have the person who wrote the book being responsible for your teaching - and you can ask me questions at any point, preferably in our discussion boards. Although here’s something you might like to know - I really don’t mind if you read ahead. If you start working and find you love this subject, keep on going with it. And something else - you are also free to google other ways of learning R. In fact we have a whole chapter about how to find answers online and where else you can go. 0.1.2 As a student learning independently If you are using this to teach yourself R you are probably a postgrad student. I would expect you to look at the chapter headings and skip around to the sections that are useful. My big tip for you would be to use the Exercises to test yourself throughout. 0.1.3 As a teacher Please feel free to mix/match and adapt these teaching materials in any way you see fit! Credit not necessary (but appreciated!) If you have any questions you are best talking to me on Twitter @jilly_mackay 0.2 Tips for using an online textbook An online textbook like this one can be a lot more flexible than a paper one. You can download it and print it if you want to make notes in the margins - the book is free for you to do what you want with it. You can change the colours on screen by hovering your mouse over the ‘A’ icon at the top left hand side of the page. Footnotes might contain something useful - or something silly. I guess you’ll need to click it to see! But remember, you can’t trust me implicitly - or anyone really↩ "],
["install.html", "Chapter 1 Installing R 1.1 Install R 1.2 Install R Studio 1.3 Using the Cloud 1.4 Install R and R Studio - Video Instruction", " Chapter 1 Installing R You can skip this chapter if you already have access to R and R Studio, and feel confident navigating between the console and environment panes. To use R on your own PC or laptop, you will need to install two things: R (the programming language) R Studio (a software that makes R easier to run) You can also access R Studio online which can be great if you have a good internet connection, or are on a computer that you don’t have admin rights to. Important: If you want to use R and R Studio on your own device you need to install both. If you prefer watching instructions you can watch the installation videos below. 1.1 Install R R is the programming language we will use. It is freely available, meaning you do not need to pay for R. To install R, you will need to navigate to (or click the link to) the Comprehensive R Archive Network - cran. While there, you want to download R for your operating system (most likely Windows or Mac). Click the link that names your operating system and look for the instructions that say install R for the first time. There will be a link that says something like Download R 4.0.2 for Windows. (The exact version number is not really important yet). After you have installed R, you can check to see if it works, or go straight to installing R Studio 1.2 Install R Studio R Studio is a tool that helps make R more user friendly. It also lets you collect all your data files into ‘projects’. This is very useful for managing your projects and ‘workflows’ (more on that here). To download R Studio follow this link. You want the R Studio Desktop Free version. You will not need to pay for anything to use R as part of your studies at R(D)SVS. When you click the download link above, you will find a button at the bottom of the page to download R Studio Desktop. After you click that button you will be able to choose the version that works for you. Follow the instructions on the page for your operating system. 1.2.1 Quick R Studio Navigation Guide If you have never coded before, R Studio might look very intimidating. In this short section we will walk through the different parts of R Studio. If you find yourself getting lost later in the book, come back here to get a refresher. In Figure 1.1 you will see a view of R Studio as you first open it. There may be some differences, e.g. you will likely have a different R Version number. Figure: 1.1: R Studio Overview 1.2.1.1 Click on File &gt; New File&gt; R Script Now your screen should look like Figure 1.2. You will have four panes in your window, and each pane can be dragged around or minimised. Note - you want to create a new R Script file, not an R Markdown or R Notebook file. We will do that next. Figure: 1.2: R Studio Overview with Script File 1.2.1.2 The file pane On the top left hand side of the R Studio window you can view the untitled R Script file you have just opened (Figure 1.3). Here you will see views of your files (mostly R Script files and R Markdown files in this book), and views of your data. Figure: 1.3: The active file pane 1.2.1.3 The console If you were using plain R (without R Studio) this console window is all you would see. Where you see this &gt; symbol in the console you can type in a simple maths equation. I recommend you type something now, perhaps 2 + 2 When you have finished typing, hit enter on your keyboard and see what the answer is. Type 2 + and then hit enter. What happens? You will need to hit ‘escape’ (‘esc’) on your keyboard to make the &gt; symbol appear again. Hitting ‘enter’ asks R to perform the last command. Because we didn’t tell R what it had to add, it kept waiting to find out what would come next. Figure: 1.4: The console pane 1.2.1.4 The Environment pane The Environment is shown in Figure 1.5. At the moment, your environment will be empty. We will talk more about what goes here in the environment section of getting started. Figure: 1.5: The environment pane 1.2.1.5 Files, plots, packages, help and viewer The final pane, shown in Figure 1.6, has five tabs in it by default. These are: Files Think of this like a Windows Explorer window (folder window) on your PC. It will show you all the files in your current folder and may just show your .Rproj file right now. Plots When we start drawing charts they’ll be saved here. Packages Other wonderful people in the R Community write lots of clever code that can be ‘packaged’ up so we can use it. Instead of writing out all the code you need to make a chart, you can use someone’s package instead. We will learn more about these in packages Help If you ever get stuck with a commaned you can type ?command_name to view the command’s documentation. Try it now by type ?summary in the console window. Remember you need to press enter on your keyboard after typing the command. Viewer This tab will show you more complicated things, like if you use R to build an html page (or a book like this one!) Ignore it for now. Figure: 1.6: File, plot, package and help viewer 1.2.1.6 Customisation Data analysis is fun, and its also personal. You can customise your R Studio to look the way you want it to. Go to Tools &gt; Global Options (Figure 1.7) Figure: 1.7: Global options And then go to Appearance &gt; Editor Theme to play around and find the colour scheme, font, and R Studio Theme you like best (Figure 1.8) Figure: 1.8: Global options, themes Personally I like the theme XCode, but it’s your R Studio! You choose the one you like. 1.3 Using the Cloud If you would like to use R Studio Cloud, you will need to create an R Studio account. This can be a whole new account, a google account, or a github account. I would recommend you get a github account (you can jump to read why here). After you have logged in, you can access a workspace. A workspace is like an R Studio Project. As of the 3rd August, 2020, R Studio Cloud is moving out of Beta and will be available to all. You should use the Cloud Free Plan. Again, we do not expect you to buy anything to use R or R Studio. You will have a maximum of 15 projects you can use, and less storage space than using your own device. 1.4 Install R and R Studio - Video Instruction If you prefer to get your resources in video format, there’s an explanation of installing R and R Studio here and using R Studio Cloud here. Please note, these videos are a bit older now so you should expect to see some minor differences, e.g. in version numbers. "],
["start.html", "Chapter 2 Getting Started 2.1 The Big Secret 2.2 Projects 2.3 Environment 2.4 Packages 2.5 R Markdown vs R Scripts 2.6 Video Introductions", " Chapter 2 Getting Started You can skip this chapter if you can: Use the console to input simple lines of code Install and load a package Recognise a function To use this chapter you will need a working version of R and R Studio. If you can open R Studio and type 2 + 2 in the console you are good to go. If that is confusing, you might need to jump back to installing R Studio and the section navigating R Studio. 2.1 The Big Secret Okay. This is the Big Secret. The thing you will not believe. The most important thing you’ll learn about R. You should copy and paste other peoples’ code. Yes, I’m serious. You should copy and paste and edit code you find online2. In this book you should always be copying bits of code and pasting it into your console. That is why I publish the code alongside it. It took me about ten years of working in R to get over my fear of copying and pasting other peoples’ code. Now I even have a repository of all the code I use over and over so I can copy and paste my own code. Most people will not remember code off the top of their head. This is why we use the help function (remember ?summary) to look at the documentation, and resources like Stack Exchange and Google to help us (more in troubleshooting). 2.1.1 Exercise You might be very skeptical here about how much I want you to be copying code. If you’re not convinced, I suggest you go watch my RStats Crush the amazing David Robinson do one of his Tidy Tuesday screencasts. David Robinson has forgotten more R than I’ll ever learn, and see - he still copies and pastes code. 2.2 Projects I would like to begin by creating a new project in R Studio. Open R Studio Go to File &gt; New Project Set up a new project either in an existing directory (folder), or in a new one. Ignore repositories for now. You can call this project anything you like. I recommend something short like ‘start’. A R Project sits inside a folder. Everything inside that folder is part of that R Project. Let’s say you have a folder called: mydata and you create an R Project called analysis. The analysis.Rproj will live inside the mydata folder, and it will ‘see’ all the data, files, and any other folders, you have in mydata. Using R Studio you will get a lot better at ‘directory management’, or knowing where you have saved things. 2.3 Environment In your brand new project you will have a clean environment (refer back to Figure 2.5). Our first exercise is going to explore what the environment really means. 2.3.1 Exercise - Environment When we first installed R, you were typing mathematical equations into the console. Let’s remind ourselves of this by running an equation now. In the console, type a long and complicated equation, then hit ‘enter’ when you’re done. 500 + 23 / 91 ## [1] 500.2527 If this was a calculation we often ran, we might want to save the answer. We can do this by using the assign symbol &lt;-. For example, if we type this: x &lt;- 500 + 23 / 91 … you will see that we simply get a new line returned. We don’t get the answer. However, in your environment you will see under the heading ‘Values’, a new thing called x. Enter the following code: x ## [1] 500.2527 R remembers what x is and recalled it. This is useful if we want to do more with x after we’ve calculated it. x /100 ## [1] 5.002527 As well as values, we can ask R to remember a string of text as well. Try this: hello &lt;- &quot;Computers always print &#39;Hello World!&#39; but we never say hello back&quot; print(hello) ## [1] &quot;Computers always print &#39;Hello World!&#39; but we never say hello back&quot; But R is very fussy. What happens if you run this code: print(HELLO) You see, R ise case sensitive, meaning we have to be careful to always type things the same. This is one of the reasons why R Studio is really handy, because you can see what you’ve saved in your environment. Now type this: hello &lt;- &quot;Hello, R!&quot; Take a guess what is going to happen before you type the next line. Were you right? print(hello) ## [1] &quot;Hello, R!&quot; 2.3.2 Exercise - Functions 2.3.2.1 The Basic Function A function is a handy way to bundle together some lines of code. David Robinson says that if you run a few lines more than twice you should write a function to do it instead. I’m going to contradict myself now. Functions are really important in R, but I’m not going to ask you to write one anywhere else but in this exercise. Most things in this book I expect you to practice over and over, but functions are useful to understand packages, and that’s why we’re going to talk about them now. Let’s create a function to make R welcome us. Copy and paste this code into a new script file (you may want to save it as your functions example), and then run it. mynameis &lt;- function (name) { print (paste0(&quot;Hello, &quot;, name, &quot;, how are you today?&quot;)) } mynameis (&quot;Jill&quot;) ## [1] &quot;Hello, Jill, how are you today?&quot; What is this code saying? Create a new thing called mynameis Give (&lt;-) mynameis the function purpose. Everything inside the curly brackets {} is the function. The function should make a new thing called name. The function should print the result of pasting a string (paste0) of things, the words Hello,, whatever you said name should be, and , how are you today?. You may have noticed that, just like when we were assigning x a value, we now have something in our environment called mynameis. Whenever we type mynameis(\"Jill\") into the console, or execute that line in a script file, R knows it should look to the environment and run the code that’s been bundled up into that package. For example, we could make R welcome us in exactly the same way by typing: print (paste0(&quot;Hello, &quot;, &quot;Jill&quot;, &quot;, how are you today?&quot;)) ## [1] &quot;Hello, Jill, how are you today?&quot; But we would need to change the name every time we wanted welcome a new user. We are lazy, so we use the function to reduce the amount of things we need to change to get a different outcome. Functions make our code more standardised. If we all define the mynameis function at the start of our documentation, we don’t need to worry about accidentally deleting an important character in the code. This is especially important as we like to copy-paste code when we need to. Most scientists will probably not write their own functions, but you should know how they work. 2.4 Packages If people write very good and useful functions, they usually want to share them. They can do this with packages. There are packages for everything, packages for drawing maps, packages for analysing data, packages for suggesting how to analyse your data, packages to give you more data, packages for tidying your data . . . this is one of the reasons we might all have different bits of code. There can be lots of ways to do something. 2.4.1 Exercise - Install and Load a Package Packages work in two stages. The very first time you need a package you need to install it. Then, every time you start R you need to load the package into your livrary. To install a package you need to type install.package(\"package_name\"). To load it into your library you need to type library(package_name). When you load a package from your library it goes into a special hidden environment where you can access all the functions that the package has written for you. For example, we will make great use of the tidyverse package in this book. You need to start by installing it with: install.packages(&quot;tidyverse&quot;) And when it has finished downloading, you need to type: library(tidyverse) to load it. You’ll see that nothing has appeared in your Environment, but actually you have a whole host of new functions &amp; data you can play with. For example: slice(starwars) Which should give you this: ## Warning: `...` is not empty. ## ## We detected these problematic arguments: ## * `needs_dots` ## ## These dots only exist to allow future extensions and should be empty. ## Did you misspecify an argument? ## # A tibble: 87 x 14 ## name height mass hair_color skin_color eye_color birth_year sex gender homeworld species films vehicles starships ## &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;lis&gt; &lt;list&gt; &lt;list&gt; ## 1 Luke Sk~ 172 77 blond fair blue 19 male mascu~ Tatooine Human &lt;chr~ &lt;chr [2~ &lt;chr [2]&gt; ## 2 C-3PO 167 75 &lt;NA&gt; gold yellow 112 none mascu~ Tatooine Droid &lt;chr~ &lt;chr [0~ &lt;chr [0]&gt; ## 3 R2-D2 96 32 &lt;NA&gt; white, blue red 33 none mascu~ Naboo Droid &lt;chr~ &lt;chr [0~ &lt;chr [0]&gt; ## 4 Darth V~ 202 136 none white yellow 41.9 male mascu~ Tatooine Human &lt;chr~ &lt;chr [0~ &lt;chr [1]&gt; ## 5 Leia Or~ 150 49 brown light brown 19 fema~ femin~ Alderaan Human &lt;chr~ &lt;chr [1~ &lt;chr [0]&gt; ## 6 Owen La~ 178 120 brown, grey light blue 52 male mascu~ Tatooine Human &lt;chr~ &lt;chr [0~ &lt;chr [0]&gt; ## 7 Beru Wh~ 165 75 brown light blue 47 fema~ femin~ Tatooine Human &lt;chr~ &lt;chr [0~ &lt;chr [0]&gt; ## 8 R5-D4 97 32 &lt;NA&gt; white, red red NA none mascu~ Tatooine Droid &lt;chr~ &lt;chr [0~ &lt;chr [0]&gt; ## 9 Biggs D~ 183 84 black light brown 24 male mascu~ Tatooine Human &lt;chr~ &lt;chr [0~ &lt;chr [1]&gt; ## 10 Obi-Wan~ 182 77 auburn, wh~ fair blue-gray 57 male mascu~ Stewjon Human &lt;chr~ &lt;chr [1~ &lt;chr [5]&gt; ## # ... with 77 more rows Now we have a new dataset (starwars) and a new thing we can do (slice the top of the data). We will talk much more about tidyverse in the data chapter. 2.5 R Markdown vs R Scripts 2.5.1 A video on R Markdown If you would like to watch me using R Markdown, you’re in luck! Theres a video here. 2.6 Video Introductions There is a short introduction to R and R Studio in Video format here: Video 1 Video 2 If you’re reading this as part of your coursework you might be panicking about plagiarism here, after all, we spend a lot of time telling you plagiarism is the worst thing you could ever do and that we’ll use software to detect it. Code is a bit different. We are always trying to find the most efficient way of doing something, and so ideally you would all write code that was identical. Sadly, humans naturally differ in the way the think about problems. My job would be a lot easier if everybody thought the same. If I have set you this book as reading, I can swear to you I will never put your code through a plagiarism checker. That would be very stupid.↩ "],
["data.html", "Chapter 3 Data 3.1 Packages for this chapter 3.2 Built In Data 3.3 Exercise 3.4 Data you create 3.5 Exercise - Creating data 3.6 Loading data from your hard drive 3.7 Loading data", " Chapter 3 Data You can skip this chapter if you: Are comfortable working with dataframes and tibbles Know about and are comfortable using some of R’s inbuilt data packages Are comfortable loading .csv and .xlsx files into R 3.1 Packages for this chapter In this chapter you’ll want the following packages loaded in your R session. At the start, you will need to run the following code. Remember if you don’t have a package you can install it with the install.package(\"package_name\") command. library(tidyverse) library(readxl) 3.2 Built In Data Many packages, such as the tidyverse package, and the default3 datasets package come with data in them. These datasets can be really useful for testing code that you’re unfamiliar with, because you know what the data should look like, and how it should perform. Some common datasets are: mpg Fuel economy data from 1999 to 2008 for 38 popular models of cars ChickWeight Weight versus age of chicks on different diets starwars Name, height, weight, age, and other characteristics of Star Wars characters iris The measurements (in cm) of the sepal length and width and petal length and width of 50 flowers in 3 species of iris There are many, many more. You can explore some of them by typing datasets:: into the console and instead of pressing ‘enter’, scroll the menu that pops up to help you autocomplete your command. You might wonder, what’s the :: in the datasets:: command. The :: is very useful and tells R to look inside the datasets package without having to actually load it into your library which can be very quick and easy 3.3 Exercise For our first exercise we are going to look at some of the inbuilt datasets. What happens when you enter the following code4 into the console? View(mpg) You should see something like Figure 3.1 Figure: 3.1: The result of the ‘View(mpg)’ command The View() command is very handy for getting a quick window onto what data looks like. Unfortunately, the View() command only really works for you getting a look at your data. If you wanted to share your code, you would be better using a command which prints some of the data into the console. So - what functions will tell R to print data into the console? You can view the top of a dataset with head() head(mpg) ## # A tibble: 6 x 11 ## manufacturer model displ year cyl trans drv cty hwy fl class ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; ## 1 audi a4 1.8 1999 4 auto(l5) f 18 29 p compact ## 2 audi a4 1.8 1999 4 manual(m5) f 21 29 p compact ## 3 audi a4 2 2008 4 manual(m6) f 20 31 p compact ## 4 audi a4 2 2008 4 auto(av) f 21 30 p compact ## 5 audi a4 2.8 1999 6 auto(l5) f 16 26 p compact ## 6 audi a4 2.8 1999 6 manual(m5) f 18 26 p compact Note that this code has produced an output block. Unlike View() where I had to share a screengrab to show you what the output of the code was. This is why head() is a lot more reproducible than View() and should be your default for code sharing. See more about this in workflows. Unsurprisingly we can also view the bottom of a dataset with … tail(mpg) ## # A tibble: 6 x 11 ## manufacturer model displ year cyl trans drv cty hwy fl class ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; ## 1 volkswagen passat 1.8 1999 4 auto(l5) f 18 29 p midsize ## 2 volkswagen passat 2 2008 4 auto(s6) f 19 28 p midsize ## 3 volkswagen passat 2 2008 4 manual(m6) f 21 29 p midsize ## 4 volkswagen passat 2.8 1999 6 auto(l5) f 16 26 p midsize ## 5 volkswagen passat 2.8 1999 6 manual(m5) f 18 26 p midsize ## 6 volkswagen passat 3.6 2008 6 auto(s6) f 17 26 p midsize Another very useful way to look at a dataset is with the summary() function, which takes its best guess at how to summarise each variable in the dataset. summary(mpg) ## manufacturer model displ year cyl trans drv ## Length:234 Length:234 Min. :1.600 Min. :1999 Min. :4.000 Length:234 Length:234 ## Class :character Class :character 1st Qu.:2.400 1st Qu.:1999 1st Qu.:4.000 Class :character Class :character ## Mode :character Mode :character Median :3.300 Median :2004 Median :6.000 Mode :character Mode :character ## Mean :3.472 Mean :2004 Mean :5.889 ## 3rd Qu.:4.600 3rd Qu.:2008 3rd Qu.:8.000 ## Max. :7.000 Max. :2008 Max. :8.000 ## cty hwy fl class ## Min. : 9.00 Min. :12.00 Length:234 Length:234 ## 1st Qu.:14.00 1st Qu.:18.00 Class :character Class :character ## Median :17.00 Median :24.00 Mode :character Mode :character ## Mean :16.86 Mean :23.44 ## 3rd Qu.:19.00 3rd Qu.:27.00 ## Max. :35.00 Max. :44.00 The summary() function highlights an important aspect of R - it knows the difference between numbers and characters. In the output block we can see that manufacturer is given the Class character. R knows it can’t create a mean and a median from this data, so it simply tells you the Length of that data instead. What do you think the 234 refers to here? Answer in the footnote5. 3.4 Data you create Sometimes you will want to test something on pretend data, or run something on a very small dataset. In these cases, we can create a dataset in our environment. This can be really useful for troubleshooting because you can create data that shows your problem, and this is easier to share with others. For example, lets say we we were interested in this idea that R only sees manufacturer in mpg as a string of letters. How can we tell R that manufacturer is in fact a category? We can test on a smaller, simpler dataset. 3.5 Exercise - Creating data We are going to use a new function here called tibble which will make a dataframe quickly and easily. Before when we were typing things like x &lt;- 1, we created a single thing in the environment. Now we want to create multiple thing (rows and columns) and that’s what the tibble function will do. Try the following and watch what happens in your environment (you’ll need the tidyverse loaded - see above) dat &lt;- tibble(x = c(1, 2, 3, 4, 5, 6), y = c(&quot;A&quot;, &quot;B&quot;, &quot;A&quot;, &quot;B&quot;, &quot;A&quot;, &quot;B&quot;)) You can View(dat) to look at this (or use head(dat)). Let’s try and replicate our weird summary(mpg) character issue. summary(dat) ## x y ## Min. :1.00 Length:6 ## 1st Qu.:2.25 Class :character ## Median :3.50 Mode :character ## Mean :3.50 ## 3rd Qu.:4.75 ## Max. :6.00 We can replicate the issue. You can see that the y variable has the class: Character. What can we do about it? We essentially want to tell R that y is not a character, but a factor6. We can ask R more directly what y is by telling it exactly where to look. is.character(dat$y) ## [1] TRUE The $ symbol tells R that it needs to look inside dat for y. Try typing out is.character(y) or is.character(dat::y) and see what happens. What are those error messages telling you? 7 If the is.character() function asks R if the named object is a character, how do you think we ask R if the named object is a factor? Try typing out your answer in the console to see what happens. We therefore need to ask R to change the data. We can do this like so: as.factor(dat$y) ## [1] A B A B A B ## Levels: A B And we get a response. But what happens if we run summary(dat) again? summary(dat) ## x y ## Min. :1.00 Length:6 ## 1st Qu.:2.25 Class :character ## Median :3.50 Mode :character ## Mean :3.50 ## 3rd Qu.:4.75 ## Max. :6.00 Why do you think this happens? You should take time to stop and answer these questions before reading on - practice and thinking about R is the best way to learn. It happens because we haven’t actually changed the data. With as.factor(dat$y), R told us the answer, but didn’t edit the object in any way. To change the dat dataframe, we need to use the assign (&lt;-) function to make sure R saves it into the environment. Here’s the fun part. We can do this in two (or actually - many) different ways. In a lot of ways, its personal preference which one you choose . . . To demonstrate, we will make two new dataframes. Option 1 option1 &lt;- tibble(x = dat$x, y = as.factor(dat$y)) Option 2 option2 &lt;- dat %&gt;% mutate(y = as.factor(y)) In Option 1, using what’s called ‘base R’, we are essentially saying something like: Make a new thing called option1 That thing is a tibble That tibble should contain x, from dat (dat$x) That tibble should contain y, from dat, made into a factor (as.factor(dat$y)) Whereas in Option 2, we are saying: Make an new thing caled option2 That thing should start the same as dat We use the pipe command from tidyverse (%&gt;%) to say ‘and then’ So take dat and then change something in dat (the mutate function) Make y a factor (y = as.factor(y)) With Option 2, we don’t need to specify dat$y because we are using the pipe function (%&gt;%) to tell R we are still working with the dat dataframe. Personally, I found the pipe function in tidyverse to be revolutionary when I learned it, and its by far my favourite way to write code. I find the code in Option 2 a lot easier to read than the code in Option 1, and we’ll be using tidyverse in the rest of this book. However, here’s another important thing: You do not have to code like I do - so long as I can run your code, we don’t have to approach a problem in the same way. This will become clearer as we work through the book. To test that we have done what we wanted to do - let’s run the summary() function again. summary(option1) ## x y ## Min. :1.00 A:3 ## 1st Qu.:2.25 B:3 ## Median :3.50 ## Mean :3.50 ## 3rd Qu.:4.75 ## Max. :6.00 summary(option2) ## x y ## Min. :1.00 A:3 ## 1st Qu.:2.25 B:3 ## Median :3.50 ## Mean :3.50 ## 3rd Qu.:4.75 ## Max. :6.00 And now we see that R has changed y into a factor, both ways, and now we have a different output to the summary() function. Thinking back to our mpg example - can you change the mpg dataset so that manufacturer is a factor? Can you change multiple variables to factors? Is tidyverse or base R easier to use for changing multiple factors? If you google, do you find other ways of changing mpg? Once you have tried these - you can view some of my answers here 3.6 Loading data from your hard drive Finally, sometimes you will have data delivered to you on a file that you will want to load in to R. These will usually be *.csv or *.xlsx files These can easily be read in with a function. The most commonly used function for *.csv files is read.csv. For excel files its read_excel from the readxl package. There are also ways to load data from URLs, and word documents, and all sorts! The skill most needed to load files from your hard drive is the ability to navigate and understand folder structures (sometimes called working directories). If your desktop has a hundred files then you should go and watch this video. 3.7 Loading data 3.7.1 Loading from a CSV ‘Default’ here means one you won’t need to install or load into the library↩ If its not working - are you sure you have spelled it with a capital View?↩ The Length of these variables is the number of rows in each one, which for this case is the same because this is a nice, tidy dataset↩ A factor is also called a categorical variable, or a grouping variable. If you’re not sure you know what a factor is, wiki is a good place to review↩ is.character(y) should give you an error message like Error: object 'y' is not found because y by itself does not exist in your environment. There’s a way around this by ‘attaching’ data to your environment, which is a bit old fashioned and can result in problems down the line with your workflow (because you won’t necessarily know if the person you’re working with has also attached the data), so I recommend against it. is.character(dat::y) should give you an error like Error in loadNamespace(name) : there is no package called 'dat'. Unsurprisingly, this is telling you that the :: sequence tells R to look inside a package for a thing called y, but that package doesn’t exist. Packages and data frames are different things.↩ "],
["charts.html", "Chapter 4 Charts 4.1 Data Vis", " Chapter 4 Charts You can skip this chapter if . . . You are confident you know the difference between a bar chart, histogram, scatterplot and line chart. You are confident you can read and interpret charts. You know what bad charts look like 4.1 Data Vis Data visualisation is one of the most important skills a scientst can learn, and being able to identify good and bad data visualisation will make you the life and soul of every party, and incredibly popular at all times. In this chapter, we’re not going to look at any R code. Instead we’re going to think about what data visualisation means. 4.1.1 When charts go bad Lets take a look at Figure 4.1. Figure: 4.1: US State of Georgia, COVID-19 Deaths, Source: https://ftalphaville.ft.com/2020/05/18/1589795135000/When-axes-get-truly-evil/ There is an excellents article from the Financial Times about this chart. I think this chart is a great example of why data visualisation is important. We use charts to communicate large amounts of data quickly and easily. Often, in life, we are trying to communicate something important. We are often trying to persuade someone to do something, like give us more research money, or to make a change that we want to see. What message do you think Figure 4.1 is trying to communicate? If you look at the x axis (the one that goes across the graph), what order are the dates in? 4.1.2 Chart anatomy 4.1.2.1 The two-axes rule Most charts will have two axes: The x axis which goes across the chart The y axis which goes up the chart (upp-y/down-y was how I used to remember it). As in data science we are often interested in does x affect y, we usually put the explanatory variable on the x axis. We try to always have the thing that drives variation going across the chart, whereas the thing that responds to variation goes up and down the chart. (The response-y variable.) You should always thing about your axes - and they should be clear to the reader from the beginning. No messing with the order (see again Figure 4.1). Unless you have a very good reason, I would always have two axes. That means if you’re trying to put in a second Y axis, you are breaking the two-axes rule, and should re-evaluate your chart. If you’re trying to make a pie-chart, you are breaking the two-axes rule, and should re-evaluate your chart. Follow the two-axes rule, and your life will be a lot easier. 4.1.2.2 Why I hate pie charts Pie charts are the worst visualisation in the world. Figure: 4.2: The worst kind of chart describing proportion of people with type of pet (fictional data) Let’s take Figure 4.2 as an example. What proportion of people have a dog versus a cat. I’ll wait for you to start puzzling through that question. If we put labels on the chart stating the value, why would we not just put data in a Figure: 4.3: A much better chart describing proportion of people with type of pet (fictional data) 4.1.2.3 Figure headings Figure headings should be a clear description of what is in the chart. 4.1.2.4 Legends Like figure headings, legends should be informative and clear. They will always describe a categorical variable, and sometimes their job will be done by the x axis. 4.1.2.5 Colours The use of colours in charts is a curious thing. Colour can be very useful in a chart, but also very distracting. There’s another brilliant FT article on the use of colour to indicate gender in charts and all the ensuing complications. 4.1.2.5.1 Advanced R users If you have gotten really into R, or you really like pretty colours, I highly recommend checking out Emil Hvitfeldt’s well maintained repository listing all the R colour palette packages out there. Personally I really like nord8 and LaCroixColoR and NineteenEightyR. Much of my life is spent tweaking colours on charts. 4.1.3 Bar charts Bar charts are good for describing a continuous (numerical) variable by a categorical (grouping) variable. The continuous variable is often the average of a group. For example: Figure: 4.4: Averge height (cm) of Star Wars characters by gender They can also be flipped around, particularly if the axis text is hard to read in one particular direction: Figure: 4.5: Averge height (cm) of Star Wars characters by species 4.1.4 Histograms A histogram shows the relative frequency of a continuous variable. For example we can see the most common height of Star Wars characters, with 20 characters, is around 180cm: Figure: 4.6: Histogram of height (cm) of Star Wars characters 4.1.5 Scatterplots Scatterplots are good for showing the relationship between two continuous variables. Figure: 4.7: Averge height (cm) of Star Wars characters by weight (kg) But we can use other aspects, such as shape or colour, to add in a categorical variable: Figure: 4.8: Averge height (cm) of Star Wars characters by weight (kg) and species 4.1.6 Boxplots Boxplots are another way to examine a continuous variable by a categorical variable, but they give us a lot more information than a bar plot does. A boxplot shows you: The median value (the thick bar in the middle) The first quartile (the lowest part of the bar) The third quartile (the highest part of the bar) A lower hinge (the bottom thin line) which roughly equates to 95% of the data will not be below this value. An upper hinge (the top thin line) which roughy equates to 95% of the data will not be above this value. Any outliers (the dots) which are observations which lie outside of 95% of the data9 Figure: 4.9: Averge height (cm) of Star Wars characters by gender 4.1.7 Infographics In our increasingly connected world, we are seeing more and more infographics. As they’re less standardised, there can be more room for interpretation. For example; As an Indian woman, I can confirm that too much of my time is spent hiding behind a rock praying the terrifying gang of international giant ladies and their Latvian general don't find me pic.twitter.com/sy9NHW9oTK — Sabah Ibrahim (@reina_sabah) August 6, 2020 I like nord so much its the colour scheme for this book↩ The hinges are actually calculated based on the boxplot.stats function which is a little more complicated than 95% of the data - but if you ever need to worry about this you have gone beyond what this book can teach you.↩ "],
["ggplot.html", "Chapter 5 ggplot2 5.1 Why ggplot? 5.2 Building a ggplot object 5.3 Exercise 5.4 Videos 5.5 Useful resources", " Chapter 5 ggplot2 You can skip this chapter if: You are confident using the ggplot2 package You can use the geom_bar, geom_point and geom_histogram arguments You can customise a ggplot2 object 5.1 Why ggplot? There is a fierce debate in the land of R. Some people think basic R shoud be taught first. Others think that you should learn how to do more complicated things first. I think you should start to learn ggplot2. ggplot2 is a really great way to learn R, and particularly the tidyverse approach to coding. It also makes beautiful charts. All my charts in the last chapter (even the dreaded pie chart) were made in ggplot2. 5.2 Building a ggplot object First - open an R Script or RMD file and load two packages: library(datasets) library(tidyverse) Let’s choose the diamonds dataset, and take a look. head(diamonds) ## # A tibble: 6 x 10 ## carat cut color clarity depth table price x y z ## &lt;dbl&gt; &lt;ord&gt; &lt;ord&gt; &lt;ord&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 0.23 Ideal E SI2 61.5 55 326 3.95 3.98 2.43 ## 2 0.21 Premium E SI1 59.8 61 326 3.89 3.84 2.31 ## 3 0.23 Good E VS1 56.9 65 327 4.05 4.07 2.31 ## 4 0.290 Premium I VS2 62.4 58 334 4.2 4.23 2.63 ## 5 0.31 Good J SI2 63.3 58 335 4.34 4.35 2.75 ## 6 0.24 Very Good J VVS2 62.8 57 336 3.94 3.96 2.48 We want to take the diamonds dataset and then (%&gt;%) send it to ggplot. In ggplot we will use the aesthetics argument (aes) to tell it what to put on the x axis and the y axis. diamonds %&gt;% ggplot(aes(x = carat, y = price)) What do you think this code will do? ** Try this code first!** This code ends up giving us a blank chart. This seems strange until you figure out that ggplot works by layering elements of a chart on top of one another: Figure: 5.1: A ggplot object with no geom layers We need to tell R to add a geom layer, and we do that by adding a + symbol. In this case, we want to add a geom_point layer, so: Figure: 5.2: A ggplot object with a geom_point layer, the price of diamonds by their carat 5.3 Exercise Create a bar chart of the mpg cars dataset Create a histogram of blah 5.4 Videos If you’d rather watch a video about this - you can here! 5.5 Useful resources There are some very useful resources out there about ggplot2 including: Cookbook for R, Winston Chang’s (free) online book about using ggplot ggplot cheatsheet, a pdf with lots of neat visualisations and cheats. "],
["dataprocessing.html", "Chapter 6 Data Processing 6.1 Workflows", " Chapter 6 Data Processing 6.1 Workflows RMDs important shit "],
["tidyverse.html", "Chapter 7 The Tidyverse 7.1 Opinionated Packages 7.2 How to tidy 7.3 The Observation 7.4 The Data 7.5 Spread", " Chapter 7 The Tidyverse The tidyverse is the only way to learn. 7.1 Opinionated Packages 7.2 How to tidy 7.3 The Observation As everyone online says - tidy data has one observation per row. My headaches came from dealing with the publicly available National Student Survey data - the format of which seems tidy to the uninitiated. The data is presented with each subject at each university as a row - that’s an observation, surely? 7.4 The Data data &lt;- tibble (group1 = c(&quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B&quot;), group2 = c(&quot;X&quot;, &quot;X&quot;, &quot;Y&quot;, &quot;Y&quot;, &quot;X&quot;, &quot;X&quot;, &quot;Z&quot;, &quot;Z&quot;), q = c (&quot;Q1&quot;, &quot;Q2&quot;,&quot;Q1&quot;, &quot;Q2&quot;, &quot;Q1&quot;, &quot;Q2&quot;, &quot;Q1&quot;, &quot;Q2&quot;), disagree = c(0.8, 0.3, 0.8, 0.2, 0.7, 0.5, 0.6, 0.3), neutral = c(0.05, 0.4, 0.1, 0.3, 0.1, 0.4, 0.2, 0.3), agree = c(0.15, 0.3, 0.1, 0.5, 0.2, 0.1, 0.2, 0.4), n = c(121, 121, 140, 140, 50, 50, 57,57)) data ## Warning: `...` is not empty. ## ## We detected these problematic arguments: ## * `needs_dots` ## ## These dots only exist to allow future extensions and should be empty. ## Did you misspecify an argument? ## # A tibble: 8 x 7 ## group1 group2 q disagree neutral agree n ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 A X Q1 0.8 0.05 0.15 121 ## 2 A X Q2 0.3 0.4 0.3 121 ## 3 A Y Q1 0.8 0.1 0.1 140 ## 4 A Y Q2 0.2 0.3 0.5 140 ## 5 B X Q1 0.7 0.1 0.2 50 ## 6 B X Q2 0.5 0.4 0.1 50 ## 7 B Z Q1 0.6 0.2 0.2 57 ## 8 B Z Q2 0.3 0.3 0.4 57 However, for a lot of what I was trying to do, I needed to know how many students responded at each level - how many agreed with Q1, Q2, etc, in each nested group. I wanted my data taller. (I’m using this specific format not because it’s a nice format, but because it’s a format that exists in the world and that lots of people make big decisions on.) 7.4.1 Gather The gather command from tidyverse is a quick way to smush this data into a tall format. The gather command creates two new columns, the key column which collects your old column names and your value column which collects the row values (fairly self-explanatory). The trick with gather is that it will smush everything it can into those two columns, so you need to tell it which columns not to include. This is the step that eluded me for a whole afternoon once, so I’m stating it very obviously here. talldata &lt;- data %&gt;% gather (key = LikertScale, value = PercRespondents, -group1, -group2, -q, -n) talldata ## Warning: `...` is not empty. ## ## We detected these problematic arguments: ## * `needs_dots` ## ## These dots only exist to allow future extensions and should be empty. ## Did you misspecify an argument? ## # A tibble: 24 x 6 ## group1 group2 q n LikertScale PercRespondents ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 A X Q1 121 disagree 0.8 ## 2 A X Q2 121 disagree 0.3 ## 3 A Y Q1 140 disagree 0.8 ## 4 A Y Q2 140 disagree 0.2 ## 5 B X Q1 50 disagree 0.7 ## 6 B X Q2 50 disagree 0.5 ## 7 B Z Q1 57 disagree 0.6 ## 8 B Z Q2 57 disagree 0.3 ## 9 A X Q1 121 neutral 0.05 ## 10 A X Q2 121 neutral 0.4 ## # ... with 14 more rows 7.4.1.1 NB - Think About Your Variable Names I once spent a whole afternoon unable to recreate an error message I was getting with gather - only to realise long after home time that I had sensibly called the key variable question which was a variable name that already existed in my dataset. R was re-writing the variable every time it gathered the data. The take home? Make sure your key and value names are unique! 7.5 Spread What if, after all that, you realise that you never wanted your data gathered at all? spread is here to rescue you. Just as before, spread wants to know the key and the value, but this time, it will split those two columns into multiple columns. This time we want all that data to be spread out like marmalade on toast, so we don’t exclude any columns (in fact, try excluding the columns and see what spread says. ) widedata &lt;- talldata %&gt;% spread (key = LikertScale, value = PercRespondents) widedata ## Warning: `...` is not empty. ## ## We detected these problematic arguments: ## * `needs_dots` ## ## These dots only exist to allow future extensions and should be empty. ## Did you misspecify an argument? ## # A tibble: 8 x 7 ## group1 group2 q n agree disagree neutral ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 A X Q1 121 0.15 0.8 0.05 ## 2 A X Q2 121 0.3 0.3 0.4 ## 3 A Y Q1 140 0.1 0.8 0.1 ## 4 A Y Q2 140 0.5 0.2 0.3 ## 5 B X Q1 50 0.2 0.7 0.1 ## 6 B X Q2 50 0.1 0.5 0.4 ## 7 B Z Q1 57 0.2 0.6 0.2 ## 8 B Z Q2 57 0.4 0.3 0.3 7.5.1 Final Thoughts There is far more that tidyverse can do to reshape your data, which I might write up at some point, but these are two great commands that eluded me for a while. Hopefully this is a very quick and simple explanation for you to look up. :) "],
["trouble.html", "Chapter 8 Troubleshooting 8.1 Important skills", " Chapter 8 Troubleshooting 8.1 Important skills working independently "],
["statsbasic.html", "Chapter 9 Basic Statistics 9.1 Descriptive stats", " Chapter 9 Basic Statistics 9.1 Descriptive stats means etc "],
["statsfreq.html", "Chapter 10 Predicting more things 10.1 Linear models 10.2 ANOVA exercise", " Chapter 10 Predicting more things 10.1 Linear models 10.2 ANOVA exercise "],
["whatnext.html", "Chapter 11 What next 11.1 github 11.2 repeatabe code 11.3 Complicated stats", " Chapter 11 What next 11.1 github 11.2 repeatabe code 11.3 Complicated stats AI - this is a good video about making AI Sabrina: I taught an AI to make pasta "],
["whyr.html", "Chapter 12 Why use R", " Chapter 12 Why use R Why is this chapter in the middle of the book? Partly because I wanted to get started faster. Partly because I think the light only shines when you learn about workflows. "],
["answers.html", "Chapter 13 Answers 13.1 Creating Data Answers", " Chapter 13 Answers 13.1 Creating Data Answers Here are the answers to Creating Data 13.1.1 Changing mpg data Changing one variable is pretty easy to do in tidyverse: mpg2 &lt;- mpg %&gt;% mutate(manufacturer = as.factor(manufacturer)) But what if we want to change all the character variables? We can still use mutate like this: mpg2 &lt;- mpg %&gt;% mutate(manufacturer = as.factor(manufacturer), model = as.factor(model), trans = as.factor(trans), drv = as.factor(drv), fl = as.factor(fl), class = as.factor(class)) Or we can use a slightly different command to apply the as.factor function across selected variables, predictably called mutate_at() mpg2 &lt;- mpg %&gt;% mutate_at(.vars = vars(c(manufacturer, model, trans, drv, fl, class)), .funs = as.factor) mutate_at becomes a very useful way of shortening your code, but can also be a little bit more difficult to remember. I very often have to look it up. But that’s fine - looking up code is good :) "],
["acks.html", "Chapter 14 Acknowledgements", " Chapter 14 Acknowledgements Rat sketch by Gordon Johnson from Pixabay, Creative Commons 0 license. Lightbulb icon by OpenClipart-Vectors from Pixabay, Creative Commons 0 license Books icon by OpenClipart-Vectors from Pixabay, Creative Commons 0 license Ian Handel fixed the CSS "]
]
